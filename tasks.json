{
    "tasks": [
        {
            "id": "1",
            "title": "Implement Vertical Sidebar UI (Arc-style)",
            "status": "completed",
            "priority": "high",
            "context": "Create a collapsible sidebar in React. Move 'Command Bar' to be accessible via shortcut (Cmd+K) or persistent button. Use simple, elegant icons.",
            "created_at": "2024-05-22T10:00:00.000000"
        },
        {
            "id": "2",
            "title": "Implement Core Web Browsing",
            "status": "completed",
            "priority": "high",
            "context": "Implemented webview-based architecture for full CSS z-index layering support. Sidebar floats over web content with blur effect.",
            "created_at": "2024-05-22T10:00:30.000000",
            "subtasks": [
                {
                    "id": "2.1",
                    "title": "Add BrowserView/webview component for web content",
                    "status": "completed"
                },
                {
                    "id": "2.2",
                    "title": "Create URL/address bar with navigation",
                    "status": "completed"
                },
                {
                    "id": "2.3",
                    "title": "Add navigation controls (back, forward, refresh)",
                    "status": "completed"
                },
                {
                    "id": "2.4",
                    "title": "Implement tab management (create, close, switch)",
                    "status": "completed"
                },
                {
                    "id": "2.5",
                    "title": "Add loading states and progress indicator",
                    "status": "completed"
                },
                {
                    "id": "2.6",
                    "title": "Handle page title and favicon updates",
                    "status": "completed"
                }
            ]
        },
        {
            "id": "3",
            "title": "Brave-level Native Ad Blocker",
            "status": "completed",
            "priority": "high",
            "context": "Use @ghostery/adblocker-electron. Fixed Electron 20+ compatibility issues by shimming registerPreloadScript. Enabled on both main process and renderer <webview> sessions.",
            "created_at": "2024-05-22T10:01:00.000000",
            "subtasks": [
                {
                    "id": "3.1",
                    "title": "Install and configure electron-ad-blocker",
                    "status": "completed"
                },
                {
                    "id": "3.2",
                    "title": "Load EasyList and other filter lists",
                    "status": "completed"
                },
                {
                    "id": "3.3",
                    "title": "Fix registerPreloadScript compatibility issue",
                    "status": "completed"
                }
            ]
        },
        {
            "id": "4",
            "title": "AI Agent Integration (browser-use)",
            "status": "completed",
            "priority": "high",
            "context": "Python FastAPI backend using browser-use library for webpage automation. Agent can click, type, scroll, navigate.",
            "created_at": "2024-05-22T10:02:00.000000",
            "subtasks": [
                {
                    "id": "4.1",
                    "title": "Set up Python backend with FastAPI",
                    "status": "completed"
                },
                {
                    "id": "4.2",
                    "title": "Integrate browser-use library",
                    "status": "completed"
                },
                {
                    "id": "4.3",
                    "title": "Create /agent/run endpoint",
                    "status": "completed"
                },
                {
                    "id": "4.4",
                    "title": "Connect frontend Command Bar to backend",
                    "status": "completed"
                }
            ]
        },
        {
            "id": "5",
            "title": "Beautiful Home Page (poseidon:// internal page)",
            "status": "completed",
            "priority": "medium",
            "context": "Custom internal page with Command Bar, quick links, and recent sites. Handles poseidon://newtab URLs.",
            "created_at": "2024-05-22T10:03:00.000000",
            "subtasks": [
                {
                    "id": "5.1",
                    "title": "Create HomePage component with gradient background",
                    "status": "completed"
                },
                {
                    "id": "5.2",
                    "title": "Implement poseidon:// URL scheme",
                    "status": "completed"
                },
                {
                    "id": "5.3",
                    "title": "Add quick links grid with favicons",
                    "status": "completed"
                },
                {
                    "id": "5.4",
                    "title": "Integrate Command Bar for search/AI",
                    "status": "completed"
                }
            ]
        },
        {
            "id": "6",
            "title": "Smart Settings (poseidon://settings)",
            "status": "completed",
            "priority": "low",
            "context": "Full settings page with 5 sections: Browser (search engine, ad blocker, HTTPS), Appearance (theme, sidebar, compact mode), Privacy (history, cookies, DNT), Tabs (behavior), Developer (devtools). Persistent storage via JSON file.",
            "created_at": "2024-05-22T10:04:00.000000"
        },
        {
            "id": "7",
            "title": "URL Autocomplete with History & Suggestions",
            "status": "completed",
            "priority": "high",
            "context": "JSON-based history storage with browser history and Google search suggestions. IPC handlers for search.",
            "created_at": "2024-05-22T10:05:00.000000",
            "subtasks": [
                {
                    "id": "7.1",
                    "title": "Implement JSON history storage (temporary)",
                    "status": "completed"
                },
                {
                    "id": "7.2",
                    "title": "Store visited URLs with title, favicon, visit count, timestamp",
                    "status": "completed"
                },
                {
                    "id": "7.3",
                    "title": "Create IPC handlers for history search/autocomplete",
                    "status": "completed"
                },
                {
                    "id": "7.4",
                    "title": "Add autocomplete dropdown to CommandBar and TopBar",
                    "status": "completed"
                },
                {
                    "id": "7.5",
                    "title": "Add Google search suggestions via IPC (CORS bypass)",
                    "status": "completed"
                }
            ]
        },
        {
            "id": "8",
            "title": "Upgrade History to SQLite Database",
            "status": "completed",
            "priority": "low",
            "context": "Migrated from JSON to better-sqlite3. Added WAL mode, prepared statements, 4 indexes for fast lookups/search. Auto-migration from old JSON file. Unlimited history storage with retention settings.",
            "created_at": "2024-05-22T10:06:00.000000",
            "subtasks": [
                {
                    "id": "8.1",
                    "title": "Configure electron-rebuild for native modules",
                    "status": "completed"
                },
                {
                    "id": "8.2",
                    "title": "Mark better-sqlite3 as external and copy .node binary",
                    "status": "completed"
                },
                {
                    "id": "8.3",
                    "title": "Migrate history storage from JSON to SQLite",
                    "status": "completed"
                },
                {
                    "id": "8.4",
                    "title": "Add database indexes for fast search",
                    "status": "completed"
                }
            ]
        },
        {
            "id": "9",
            "title": "Fix URL Bar Not Updating on Navigation",
            "status": "completed",
            "priority": "high",
            "context": "URL bar shows old URL (e.g., google.com) after clicking links to navigate to new pages. Fixed by syncing renderer <webview> state to main process via IPC.",
            "created_at": "2024-05-22T10:07:00.000000"
        },
        {
            "id": "10",
            "title": "Fix Suggestion Dropdown Persisting After Navigation",
            "status": "completed",
            "priority": "medium",
            "context": "Suggestions remained open when manually typing a URL/search and pressing Enter, due to late-arriving async fetch results. Fixed by checking input focus before showing results.",
            "created_at": "2024-05-22T12:00:00.000000"
        },
        {
            "id": "11",
            "title": "Implement Aggressive Ad & Popup Blocking for Streaming Sites",
            "status": "completed",
            "priority": "high",
            "context": "Block popups and new tabs on streaming sites (football matches) using ad blocker engine logic. Similar to Brave's aggressive blocking. Intercepts window.open via setWindowOpenHandler.",
            "created_at": "2024-05-22T14:00:00.000000"
        },
        {
            "id": "12",
            "title": "Fix YouTube Reload Loop & Stabilize Ad Blocker",
            "status": "completed",
            "priority": "high",
            "context": "Video reload loop caused by duplicate IPC handler registration crashing the app when opening tabs/switching focus. Fixed by sharing webview session (partition) and checking initialization status. Restricted ad blocker to single session to prevent global IPC conflicts.",
            "created_at": "2024-05-22T15:00:00.000000"
        },
        {
            "id": "13",
            "title": "Implement Arc-style Sidebar with Realms & Docks",
            "status": "completed",
            "priority": "high",
            "context": "All core features complete: Realms, Docks, tab organization, drag-and-drop with visual indicators, context menus, pinning, realm search (Cmd+Shift+K), TopBar indicator. Nice-to-have deferred: Templates (13.15), Tab Splitting (13.16).",
            "created_at": "2025-02-05T12:00:00.000000",
            "subtasks": [
                {
                    "id": "13.1",
                    "title": "Design & Create Data Models",
                    "status": "completed",
                    "context": "Define TypeScript interfaces for Realm, Dock, and enhanced Tab structures. Realms contain Docks and loose tabs. Docks contain tabs and have collapsed state. Each entity needs unique IDs, names, colors/icons, ordering, and timestamps.",
                    "subtasks": [
                        {
                            "id": "13.1.1",
                            "title": "Create Realm interface (id, name, icon, color, dockIds[], looseTabIds[], order, createdAt)",
                            "status": "pending"
                        },
                        {
                            "id": "13.1.2",
                            "title": "Create Dock interface (id, name, icon, color, tabIds[], isCollapsed, realmId, order)",
                            "status": "pending"
                        },
                        {
                            "id": "13.1.3",
                            "title": "Extend Tab interface to include dockId (optional), realmId, and order fields",
                            "status": "pending"
                        },
                        {
                            "id": "13.1.4",
                            "title": "Create SidebarState interface (activeRealmId, realms[], docks[], expandedDockIds[])",
                            "status": "pending"
                        }
                    ]
                },
                {
                    "id": "13.2",
                    "title": "Implement Persistent Storage Layer",
                    "status": "completed",
                    "context": "Create a storage module for Realms and Docks using JSON file storage (similar to history.ts). Handle CRUD operations with debounced saves. Store in userData directory. Consider future SQLite migration.",
                    "subtasks": [
                        {
                            "id": "13.2.1",
                            "title": "Create src/main/store.ts with RealmStore class",
                            "status": "pending"
                        },
                        {
                            "id": "13.2.2",
                            "title": "Implement CRUD operations for Realms (create, read, update, delete, reorder)",
                            "status": "pending"
                        },
                        {
                            "id": "13.2.3",
                            "title": "Implement CRUD operations for Docks (create, read, update, delete, reorder, collapse/expand)",
                            "status": "pending"
                        },
                        {
                            "id": "13.2.4",
                            "title": "Implement tab-to-dock/realm assignment operations (move tab to dock, move to loose, move between docks)",
                            "status": "pending"
                        },
                        {
                            "id": "13.2.5",
                            "title": "Add debounced file persistence with atomic writes",
                            "status": "pending"
                        },
                        {
                            "id": "13.2.6",
                            "title": "Create default realm on first launch (e.g., 'General' realm)",
                            "status": "pending"
                        }
                    ]
                },
                {
                    "id": "13.3",
                    "title": "Create IPC Handlers for Realm/Dock Management",
                    "status": "completed",
                    "context": "Expose storage operations to renderer via IPC. Follow existing patterns in main.ts and preload.ts.",
                    "subtasks": [
                        {
                            "id": "13.3.1",
                            "title": "Add IPC handlers in main.ts for realm operations (get-realms, create-realm, update-realm, delete-realm, switch-realm, reorder-realms)",
                            "status": "pending"
                        },
                        {
                            "id": "13.3.2",
                            "title": "Add IPC handlers for dock operations (get-docks, create-dock, update-dock, delete-dock, toggle-dock-collapse, reorder-docks)",
                            "status": "pending"
                        },
                        {
                            "id": "13.3.3",
                            "title": "Add IPC handlers for tab organization (move-tab-to-dock, move-tab-to-loose, move-tab-to-realm, reorder-tabs-in-dock)",
                            "status": "pending"
                        },
                        {
                            "id": "13.3.4",
                            "title": "Update preload.ts to expose realms and docks APIs to renderer",
                            "status": "pending"
                        },
                        {
                            "id": "13.3.5",
                            "title": "Add IPC events for state change notifications (realm-updated, dock-updated, tab-organization-changed)",
                            "status": "pending"
                        }
                    ]
                },
                {
                    "id": "13.4",
                    "title": "Modify Tab Creation to Support Realms/Docks",
                    "status": "completed",
                    "context": "Update createTab() in main.ts to assign tabs to active realm. Handle tab assignment when realm/dock context is provided.",
                    "subtasks": [
                        {
                            "id": "13.4.1",
                            "title": "Update createTab() to accept optional realmId and dockId parameters",
                            "status": "pending"
                        },
                        {
                            "id": "13.4.2",
                            "title": "Auto-assign new tabs to active realm as loose tabs by default",
                            "status": "pending"
                        },
                        {
                            "id": "13.4.3",
                            "title": "Update Tab interface in main.ts to include realmId and dockId",
                            "status": "pending"
                        },
                        {
                            "id": "13.4.4",
                            "title": "Handle tab close to remove from dock/realm associations",
                            "status": "pending"
                        }
                    ]
                },
                {
                    "id": "13.5",
                    "title": "Build Realm Switcher UI Component",
                    "status": "completed",
                    "context": "Create the realm navigation at top/bottom of sidebar. Support visual switching, keyboard shortcuts, and swipe gestures.",
                    "subtasks": [
                        {
                            "id": "13.5.1",
                            "title": "Create RealmSwitcher.tsx component with horizontal realm indicators",
                            "status": "pending"
                        },
                        {
                            "id": "13.5.2",
                            "title": "Display realm icons/colors with active state indicator",
                            "status": "pending"
                        },
                        {
                            "id": "13.5.3",
                            "title": "Add click-to-switch realm functionality",
                            "status": "pending"
                        },
                        {
                            "id": "13.5.4",
                            "title": "Implement swipe left/right gesture detection for realm switching",
                            "status": "pending"
                        },
                        {
                            "id": "13.5.5",
                            "title": "Add keyboard shortcuts for realm switching (Ctrl/Cmd + 1-9 or arrow keys)",
                            "status": "pending"
                        },
                        {
                            "id": "13.5.6",
                            "title": "Add '+' button to create new realm with name/icon picker modal",
                            "status": "pending"
                        },
                        {
                            "id": "13.5.7",
                            "title": "Add context menu for realm (rename, change icon/color, delete)",
                            "status": "pending"
                        }
                    ]
                },
                {
                    "id": "13.6",
                    "title": "Build Dock Component with Collapse/Expand",
                    "status": "completed",
                    "context": "Create the collapsible dock UI that contains grouped tabs. Show dock header with collapse toggle, tab count, and nested tabs.",
                    "subtasks": [
                        {
                            "id": "13.6.1",
                            "title": "Create Dock.tsx component with header (name, icon, collapse toggle, tab count)",
                            "status": "pending"
                        },
                        {
                            "id": "13.6.2",
                            "title": "Implement collapse/expand animation for dock contents",
                            "status": "pending"
                        },
                        {
                            "id": "13.6.3",
                            "title": "Render nested tab list inside dock (indented styling)",
                            "status": "pending"
                        },
                        {
                            "id": "13.6.4",
                            "title": "Add context menu for dock (rename, change color/icon, delete, move to realm)",
                            "status": "pending"
                        },
                        {
                            "id": "13.6.5",
                            "title": "Show dock badge with tab count when collapsed",
                            "status": "pending"
                        },
                        {
                            "id": "13.6.6",
                            "title": "Add '+' button on dock header to create new tab inside dock",
                            "status": "pending"
                        }
                    ]
                },
                {
                    "id": "13.7",
                    "title": "Refactor Sidebar.tsx for Hierarchical Structure",
                    "status": "completed",
                    "context": "Transform Sidebar.tsx from flat tab list to realm-aware hierarchical view showing docks and loose tabs for the active realm.",
                    "subtasks": [
                        {
                            "id": "13.7.1",
                            "title": "Add state management for activeRealmId and subscribe to realm changes",
                            "status": "pending"
                        },
                        {
                            "id": "13.7.2",
                            "title": "Replace flat tabs list with: Docks section + Loose Tabs section",
                            "status": "pending"
                        },
                        {
                            "id": "13.7.3",
                            "title": "Integrate RealmSwitcher component at sidebar bottom",
                            "status": "pending"
                        },
                        {
                            "id": "13.7.4",
                            "title": "Filter displayed tabs to only show active realm's tabs",
                            "status": "pending"
                        },
                        {
                            "id": "13.7.5",
                            "title": "Add 'Create Dock' button in sidebar for grouping tabs",
                            "status": "pending"
                        },
                        {
                            "id": "13.7.6",
                            "title": "Update 'New Tab' button to create tab in active realm",
                            "status": "pending"
                        }
                    ]
                },
                {
                    "id": "13.8",
                    "title": "Implement Drag-and-Drop for Tab Organization",
                    "status": "completed",
                    "context": "Tab drag-and-drop fully implemented using @dnd-kit. Dock reordering via drag also implemented.",
                    "subtasks": [
                        {
                            "id": "13.8.1",
                            "title": "Add drag handles to tab items in sidebar",
                            "status": "completed"
                        },
                        {
                            "id": "13.8.2",
                            "title": "Implement drag-to-reorder tabs within same dock",
                            "status": "completed"
                        },
                        {
                            "id": "13.8.3",
                            "title": "Implement drag tab from dock to loose section",
                            "status": "completed"
                        },
                        {
                            "id": "13.8.4",
                            "title": "Implement drag tab from loose to dock",
                            "status": "completed"
                        },
                        {
                            "id": "13.8.5",
                            "title": "Implement drag tab between different docks",
                            "status": "completed"
                        },
                        {
                            "id": "13.8.6",
                            "title": "Implement drag dock to reorder within realm",
                            "status": "completed"
                        },
                        {
                            "id": "13.8.7",
                            "title": "Add visual drop indicators and hover states during drag",
                            "status": "completed"
                        },
                        {
                            "id": "13.8.8",
                            "title": "Persist order changes after drop",
                            "status": "completed"
                        }
                    ]
                },
                {
                    "id": "13.9",
                    "title": "Create Realm/Dock Management Modals",
                    "status": "completed",
                    "context": "Build modal dialogs for creating and editing realms and docks with name, icon, and color selection.",
                    "subtasks": [
                        {
                            "id": "13.9.1",
                            "title": "Create RealmModal.tsx for create/edit realm (name input, icon picker, color picker)",
                            "status": "pending"
                        },
                        {
                            "id": "13.9.2",
                            "title": "Create DockModal.tsx for create/edit dock (name input, icon picker, color picker)",
                            "status": "pending"
                        },
                        {
                            "id": "13.9.3",
                            "title": "Create IconPicker.tsx component with curated icon set",
                            "status": "pending"
                        },
                        {
                            "id": "13.9.4",
                            "title": "Create ColorPicker.tsx component with preset color palette",
                            "status": "pending"
                        },
                        {
                            "id": "13.9.5",
                            "title": "Add confirmation dialog for delete operations",
                            "status": "pending"
                        }
                    ]
                },
                {
                    "id": "13.10",
                    "title": "Implement Context Menus",
                    "status": "completed",
                    "context": "Full context menu system with ContextMenu.tsx component, useContextMenu hook, and submenu support.",
                    "subtasks": [
                        {
                            "id": "13.10.1",
                            "title": "Create ContextMenu.tsx reusable component",
                            "status": "completed"
                        },
                        {
                            "id": "13.10.2",
                            "title": "Add tab context menu (Close, Move to Dock submenu, Move to Realm submenu, Pin/Unpin)",
                            "status": "completed"
                        },
                        {
                            "id": "13.10.3",
                            "title": "Add dock context menu (Rename, Change Icon, Change Color, Collapse/Expand, Delete)",
                            "status": "completed"
                        },
                        {
                            "id": "13.10.4",
                            "title": "Add realm context menu (Rename, Change Icon, Change Color, Delete)",
                            "status": "completed"
                        }
                    ]
                },
                {
                    "id": "13.11",
                    "title": "Handle Edge Cases & UX Polish",
                    "status": "completed",
                    "context": "Edge cases handled in store.ts (deleteRealm moves tabs to default, deleteDock moves tabs to loose, last realm protected).",
                    "subtasks": [
                        {
                            "id": "13.11.1",
                            "title": "Handle empty realm state (show 'Create your first dock' prompt)",
                            "status": "completed"
                        },
                        {
                            "id": "13.11.2",
                            "title": "Handle realm deletion (move tabs to default realm or prompt user)",
                            "status": "completed"
                        },
                        {
                            "id": "13.11.3",
                            "title": "Handle dock deletion (move tabs to loose section of same realm)",
                            "status": "completed"
                        },
                        {
                            "id": "13.11.4",
                            "title": "Prevent deletion of last realm (always keep at least one)",
                            "status": "completed"
                        },
                        {
                            "id": "13.11.5",
                            "title": "Add smooth animations for realm transitions",
                            "status": "completed"
                        },
                        {
                            "id": "13.11.6",
                            "title": "Add keyboard navigation within sidebar (arrow keys, enter, escape)",
                            "status": "pending"
                        },
                        {
                            "id": "13.11.7",
                            "title": "Remember collapsed/expanded state of docks across sessions",
                            "status": "completed"
                        }
                    ]
                },
                {
                    "id": "13.12",
                    "title": "Testing & Stability",
                    "status": "pending",
                    "context": "Thoroughly test all interactions, persistence, and edge cases. Ensure no data loss on crashes.",
                    "subtasks": [
                        {
                            "id": "13.12.1",
                            "title": "Test realm CRUD operations (create, rename, reorder, delete)",
                            "status": "pending"
                        },
                        {
                            "id": "13.12.2",
                            "title": "Test dock CRUD operations (create, rename, collapse, reorder, delete)",
                            "status": "pending"
                        },
                        {
                            "id": "13.12.3",
                            "title": "Test tab movement between docks and realms",
                            "status": "pending"
                        },
                        {
                            "id": "13.12.4",
                            "title": "Test persistence across app restarts",
                            "status": "pending"
                        },
                        {
                            "id": "13.12.5",
                            "title": "Test drag-and-drop across all scenarios",
                            "status": "pending"
                        },
                        {
                            "id": "13.12.6",
                            "title": "Test keyboard shortcuts and accessibility",
                            "status": "pending"
                        }
                    ]
                },
                {
                    "id": "13.13",
                    "title": "Tab Pinning Feature",
                    "status": "completed",
                    "context": "Pinned tabs section at top of sidebar, pin/unpin in context menu, persisted in store, IPC handlers in main.ts.",
                    "subtasks": [
                        {
                            "id": "13.13.1",
                            "title": "Add isPinned field to Tab interface",
                            "status": "completed"
                        },
                        {
                            "id": "13.13.2",
                            "title": "Create PinnedTabs section at top of sidebar (above docks)",
                            "status": "completed"
                        },
                        {
                            "id": "13.13.3",
                            "title": "Add pin/unpin toggle in tab context menu and as icon button",
                            "status": "completed"
                        },
                        {
                            "id": "13.13.4",
                            "title": "Style pinned tabs distinctly (compact, icon-only option, or full)",
                            "status": "completed"
                        },
                        {
                            "id": "13.13.5",
                            "title": "Persist pinned state in storage",
                            "status": "completed"
                        },
                        {
                            "id": "13.13.6",
                            "title": "Add IPC handlers for pin/unpin operations",
                            "status": "completed"
                        }
                    ]
                },
                {
                    "id": "13.14",
                    "title": "Quick Realm Search (Cmd+Shift+K)",
                    "status": "completed",
                    "context": "RealmSearch.tsx modal with fuzzy search across all tabs, realm/dock breadcrumbs, keyboard navigation.",
                    "subtasks": [
                        {
                            "id": "13.14.1",
                            "title": "Create RealmSearch.tsx modal component with search input",
                            "status": "completed"
                        },
                        {
                            "id": "13.14.2",
                            "title": "Implement search across all tabs in all realms (fuzzy match on title/URL)",
                            "status": "completed"
                        },
                        {
                            "id": "13.14.3",
                            "title": "Display results with realm/dock breadcrumb (e.g., 'Gaming > COD > Tab Name')",
                            "status": "completed"
                        },
                        {
                            "id": "13.14.4",
                            "title": "Add keyboard navigation (arrow keys, enter to select, escape to close)",
                            "status": "completed"
                        },
                        {
                            "id": "13.14.5",
                            "title": "Register Cmd+Shift+K global shortcut to open search",
                            "status": "completed"
                        },
                        {
                            "id": "13.14.6",
                            "title": "On selection: switch to tab's realm and activate the tab",
                            "status": "completed"
                        }
                    ]
                },
                {
                    "id": "13.15",
                    "title": "Realm Templates",
                    "status": "completed",
                    "context": "Pre-configured realm templates for common use cases (Developer, Social, Entertainment, etc.) with suggested docks. Users can choose a template when creating a new realm.",
                    "subtasks": [
                        {
                            "id": "13.15.1",
                            "title": "Define template data structure (name, icon, color, defaultDocks[])",
                            "status": "completed"
                        },
                        {
                            "id": "13.15.2",
                            "title": "Create templates: Developer (GitHub, Docs, Stack Overflow), Social (Twitter, Reddit, Discord), Entertainment (YouTube, Netflix, Spotify), Work (Email, Calendar, Notion)",
                            "status": "completed"
                        },
                        {
                            "id": "13.15.3",
                            "title": "Add template selection step in RealmModal when creating new realm",
                            "status": "completed"
                        },
                        {
                            "id": "13.15.4",
                            "title": "Option to start from blank or choose template",
                            "status": "completed"
                        },
                        {
                            "id": "13.15.5",
                            "title": "Auto-create docks from template on realm creation",
                            "status": "completed"
                        }
                    ]
                },
                {
                    "id": "13.16",
                    "title": "Tab Splitting (Drag to Create Dock)",
                    "status": "completed",
                    "context": "When dragging a tab to an empty area or special drop zone, automatically create a new dock containing that tab. Quick way to organize without manual dock creation.",
                    "subtasks": [
                        {
                            "id": "13.16.1",
                            "title": "Add 'New Dock' drop zone that appears during tab drag",
                            "status": "completed"
                        },
                        {
                            "id": "13.16.2",
                            "title": "Detect drop on 'New Dock' zone and trigger dock creation flow",
                            "status": "completed"
                        },
                        {
                            "id": "13.16.3",
                            "title": "Auto-name new dock based on tab title or domain",
                            "status": "completed"
                        },
                        {
                            "id": "13.16.4",
                            "title": "Move the dragged tab into the newly created dock",
                            "status": "pending"
                        },
                        {
                            "id": "13.16.5",
                            "title": "Add visual feedback during drag showing dock creation preview",
                            "status": "pending"
                        }
                    ]
                },
                {
                    "id": "13.17",
                    "title": "Realm Indicator in TopBar",
                    "status": "completed",
                    "context": "Realm indicator with dropdown in TopBar. Shows current realm icon, name, color. Click to switch realms.",
                    "subtasks": [
                        {
                            "id": "13.17.1",
                            "title": "Add RealmIndicator component to TopBar (left of URL bar)",
                            "status": "completed"
                        },
                        {
                            "id": "13.17.2",
                            "title": "Display current realm icon and name with color accent",
                            "status": "completed"
                        },
                        {
                            "id": "13.17.3",
                            "title": "Click to open realm dropdown/switcher inline",
                            "status": "completed"
                        },
                        {
                            "id": "13.17.4",
                            "title": "Subscribe to realm changes to keep indicator in sync",
                            "status": "completed"
                        },
                        {
                            "id": "13.17.5",
                            "title": "Subtle color bar or border showing realm color",
                            "status": "completed"
                        }
                    ]
                }
            ]
        },
        {
            "id": "14",
            "title": "Fix Sidebar Pinning Behavior",
            "status": "completed",
            "priority": "high",
            "context": "Currently, pinning the sidebar makes it float over content, obscuring the left side of web pages. When pinned, it should shift the web view content area to the right so that no content is hidden, effectively resizing the browser view area.",
            "created_at": "2024-06-15T10:00:00.000000"
        },
        {
            "id": "15",
            "title": "Instant Tab Name Updates",
            "status": "completed",
            "priority": "medium",
            "context": "Tab names currently only update on new tab creation or reload. They should update instantly when navigation occurs (e.g. visiting YouTube or searching Google) to reflect the new page title.",
            "created_at": "2024-06-15T10:05:00.000000"
        },
        {
            "id": "16",
            "title": "Fix Reload Behavior",
            "status": "completed",
            "priority": "medium",
            "context": "Reloading a page currently creates a new tab instead of refreshing the current one. Fixed by: (1) Adding custom Electron Menu that intercepts Cmd+R/Cmd+Shift+R to reload the active webview via IPC instead of reloading the main window, (2) Guarding did-finish-load handler to only create initial tab when no tabs exist, preventing duplicate tab creation on renderer reload.",
            "created_at": "2024-06-15T10:10:00.000000"
        },
        {
            "id": "17",
            "title": "Fix Navigation Controls (Back/Forward/Swipe)",
            "status": "completed",
            "priority": "high",
            "context": "Fixed: (1) Removed duplicate nav buttons from outside URL bar (kept inline ones). (2) tabsWithWebview now populated from all web navigations (not just URL bar), ensuring canGoBack fallback works for link-navigated tabs. (3) Added two-finger trackpad swipe gesture support (horizontal wheel events) for back/forward navigation. (4) Cleaned up verbose console.logs from TopBar, App, and main process.",
            "created_at": "2024-06-15T10:15:00.000000"
        },
        {
            "id": "18",
            "title": "Phase 1: Agent Runs Inside Poseidon (CDP Integration)",
            "status": "completed",
            "priority": "high",
            "context": "Agent runs inside Poseidon tabs via CDP (--remote-debugging-port=9222). BrowserViews attached off-screen for rendering surface. Screenshots optimized with JPEG+optimizeForSpeed. Navigation guards preserve poseidon:// URLs. Off-screen BrowserView audio muted. Agent prompted to call done action on completion.",
            "created_at": "2026-02-09T10:00:00.000000",
            "subtasks": [
                {
                    "id": "18.1",
                    "title": "Enable CDP remote debugging on Electron",
                    "status": "completed",
                    "context": "--remote-debugging-port=9222 in main.ts app launch args."
                },
                {
                    "id": "18.2",
                    "title": "Add IPC handler to create an agent tab and return its target info",
                    "status": "completed",
                    "context": "IPC 'create-agent-tab' with before/after CDP /json target diffing to identify exact new target ID."
                },
                {
                    "id": "18.3",
                    "title": "Add backend endpoint to accept CDP URL + target info",
                    "status": "completed",
                    "context": "/agent/run accepts cdp_url and target_id. BrowserSession(cdp_url=..., keep_alive=True)."
                },
                {
                    "id": "18.4",
                    "title": "Update frontend agent flow: create tab first, then call backend with CDP info",
                    "status": "completed",
                    "context": "TopBar handleRunAgent: create-agent-tab IPC → POST /agent/run with cdp_url + target_id."
                },
                {
                    "id": "18.5",
                    "title": "Keep tab alive after agent completes (keep_alive=True)",
                    "status": "completed",
                    "context": "BrowserSession keep_alive=True. Tab persists for continued browsing."
                },
                {
                    "id": "18.6",
                    "title": "Test end-to-end: agent task runs visibly inside Poseidon tab",
                    "status": "completed",
                    "context": "Verified: agent opens YouTube, searches, clicks video, plays it — all inside Poseidon tab. Home tab preserved. Audio muted on off-screen BrowserView."
                },
                {
                    "id": "18.7",
                    "title": "Fix CDP rendering surface for DOM extraction and screenshots",
                    "status": "completed",
                    "context": "BrowserViews attached to window off-screen (y:-10000) via addBrowserView(). This gives CDP a rendering surface for DOM extraction, screenshots, and AX tree on JS-heavy sites. Audio muted on off-screen views. Screenshots patched to JPEG quality=40 optimizeForSpeed."
                }
            ]
        },
        {
            "id": "19",
            "title": "Phase 2: Fast Path for Simple Agent Actions",
            "status": "pending",
            "priority": "medium",
            "context": "Bypass browser-use's full pipeline for simple commands (navigate, click) by sending CDP commands directly to the Poseidon tab. Only use full browser-use for complex multi-step tasks.",
            "created_at": "2026-02-09T10:01:00.000000",
            "subtasks": [
                {
                    "id": "19.1",
                    "title": "Build lightweight CDP command layer in Python",
                    "status": "pending",
                    "context": "Direct CDP calls for navigate, click, type, scroll — no DOM extraction, no screenshots, no LLM. Used for simple one-shot commands."
                },
                {
                    "id": "19.2",
                    "title": "Add intent classifier to route simple vs complex tasks",
                    "status": "pending",
                    "context": "Quick LLM call or regex to decide: 'go to youtube.com' → fast path, 'find cheapest flight to NYC' → full browser-use pipeline."
                },
                {
                    "id": "19.3",
                    "title": "Implement streaming progress updates via WebSocket/SSE",
                    "status": "pending",
                    "context": "Replace blocking POST with streaming so frontend shows step-by-step agent progress in real time."
                }
            ]
        },
        {
            "id": "20",
            "title": "Phase 3: Custom Agent Loop & browser-use Fork",
            "status": "pending",
            "priority": "low",
            "context": "Fork browser-use and optimize for Poseidon: skip screenshots when not needed, two-tier agent (quick/deep), custom DOM extraction, tighter Electron integration.",
            "created_at": "2026-02-09T10:02:00.000000",
            "subtasks": [
                {
                    "id": "20.1",
                    "title": "Fork browser-use into poseidon-agent package",
                    "status": "pending",
                    "context": "Vendor browser-use source into project. Remove unused features, add Poseidon-specific optimizations."
                },
                {
                    "id": "20.2",
                    "title": "Make screenshots optional per step",
                    "status": "completed",
                    "context": "DONE via use_vision='auto' in Agent config. Agent only requests screenshots when it explicitly needs visual info (via screenshot action). Combined with monkey-patched screenshot handler that has 5s timeout + graceful fallback to None. Full fix requires task 18.7 (rendering surface) so screenshots actually work when requested."
                },
                {
                    "id": "20.3",
                    "title": "Build two-tier agent: quick mode (minimal DOM) vs deep mode (full pipeline)",
                    "status": "pending",
                    "context": "Quick mode: small DOM snapshot, no screenshot, fast LLM call. Deep mode: full browser-use pipeline with vision."
                },
                {
                    "id": "20.4",
                    "title": "Integrate agent tab management with Poseidon's tab system",
                    "status": "pending",
                    "context": "Agent's new-tab/close-tab actions create/close real Poseidon tabs via IPC instead of CDP-level targets."
                }
            ]
        }
    ]
}